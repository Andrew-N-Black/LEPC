
library(ComplexHeatmap)
library(circlize)
library(RColorBrewer)
#Wilcox test for heterozygosity between leks
Heatmap(data, rect_gp = gpar(type = "none"),row_names_side = "left",row_names_gp = gpar(fontsize = 4),column_names_gp = gpar(fontsize = 4),col = colorRamp2(c(0.05,0.25,0.5,0.75,1), c("black","red","orange","grey","white")),row_split =factor(c("Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic"),levels = c("Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie")),column_split = factor(c("Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shortgrass-CRP-Mosaic","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Shinnery-Oak-Prairie","Mixed-Grass-Prairie","Mixed-Grass-Prairie","Shortgrass-CRP-Mosaic"),levels = c("Mixed-Grass-Prairie","Shinnery-Oak-Prairie","Shortgrass-CRP-Mosaic","Sand-Sagebrush-Prairie")),name = "P-value",row_title_gp = gpar(col = c("blue","bisque","darkolivegreen3","darkorchid1"), fontsize = 6), cluster_rows = FALSE, cluster_row_slices=F,cluster_columns = FALSE,row_title_rot = 0,column_title_gp = gpar(col = c("blue","bisque","darkolivegreen3","darkorchid1"), fontsize = 6),column_title_rot = 45,
        cell_fun = function(j, i, x, y, w, h, fill) {
            if(i >= j) {
                grid.rect(x, y, w, h, gp = gpar(fill = fill, col = fill))
            }
        })
        
        
